<p-panel [toggleable]="true">
  <ng-template pTemplate="header"><span class="text-primary font-semibold text-xl">Основные учетные данные пользователя</span>
  </ng-template>
  <ng-template pTemplate="content">
    <div class="mb-2 font-bold">Аккаунт создан: <span
      class="font-normal">{{userProfile.createdAt.toString() | date:'full':'ru' }}</span></div>
    <div class="mb-2 font-bold">Последнее изменение: <span
      class="font-normal">{{userProfile.updatedAt.toString() | date:'full':'ru' }} </span></div>
    <div class="mb-4 font-bold">Статус аккаунта: <span [ngClass]="[statusClasses()]" class="font-normal font-italic">{{userStatus() }}</span></div>
    <form
      class="mt-1"
      [formGroup]="userForm"
      novalidate
      (ngSubmit)="submitUserFrm()">
      <div class="flex justify-content-start align-items-center">
        <span class="p-float-label w-20rem">
          <input
            pInputText
            id="email"
            class="p-inputtext-sm w-full"
            formControlName="emailControl"
            (focusout)="checkEmail()"
            [ngClass]="{'ng-invalid ng-dirty':(emailControl.invalid)&&emailControl.touched}"
          />
         <label htmlFor="email">Email</label>
        </span>
        <span class="ml-2">
          <span *ngIf="userProfile.isEmailVerified&&!emailControlChanged&&!isCounterShow"
                class="font-italic font-semibold text-green-400">
            Почта подтверждена
          </span>
          <span *ngIf="isCounterShow">
            <app-count-down [time]="" [chronos]=""></app-count-down>
          </span>
          <span *ngIf="!userProfile.isEmailVerified&&!emailControlChanged&&!isCounterShow">
            <p-button
              label="Подтвердить почту"
              styleClass="p-button-raised ml-5"
              [loading]="sendEmailVerifyTokenLoaded"
              (click)="sendEmailVerifyToken()"></p-button>
          </span>
        </span>
      </div>
      <div class="flex justify-content-start align-items-center">
        <div>
            <span class="p-float-label mt-4">
              <p-inputMask
                mask="+7(999) 999-9999"
                id="phone"
                formControlName="phoneControl"
                (focusout)="checkPhone()"
                [ngClass]="{'ng-invalid ng-dirty':(phoneControl.invalid)&&phoneControl.touched}"
              ></p-inputMask>
              <label htmlFor="phone">Телефон</label>
            </span>
        </div>
        <span *ngIf="userProfile.isPhoneVerified&&!phoneControlChanged"
              class="font-italic font-semibold text-green-400 mt-4">Телефон подтвержден</span>
        <span *ngIf="!userProfile.isPhoneVerified&&!phoneControlChanged" class="mt-4">
            <p-button
              label="Подтвердить телефон"
              styleClass="p-button-raised ml-5"
              [loading]="sendPhoneVerifyTokenLoaded"
              (click)="sendPhoneVerifyToken()"></p-button>
          </span>
        <span *ngIf="!phoneControl.value" class="mt-4">
            Введите номер Вашего телефона.
          </span>
      </div>
      <div class="mt-4">
        <p>В соответствии с настройками установленными Администратором,каждые {{pswStrangeReq?.passwordExpired}} {{passwordExpired}} необходимо менять пароль.</p>
        <p>Текущий Ваш пароль можно использовать для входа в приложение до <span class="font-bold">{{userProfile.credentialExpiredTime.toString() | date:'short':'ru'}}.</span></p>
        <p>По истечению этого времени войти в приложение с этим паролем будет невозможно.</p>
      </div>
      <p-button
        label="Сменить пароль"
        styleClass="p-button-raised mt-3"
        (click)="changePasswordFormShow()"></p-button>
      <div class="mt-4">
        <span class="font-bold">Вам назначены следующие роли:</span>
        <p-table [value]="userProfile.roles" [tableStyle]="{ 'width': '100%','margin-top':'1rem' }">
          <ng-template pTemplate="header">
            <tr>
              <th>Название </th>
              <th>Описание роли</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body">
            <tr *ngFor="let row of userProfile.roles">
              <td>{{row.title}}</td>
              <td>{{row.description}}</td>
            </tr>
          </ng-template>
        </p-table>
      </div>
      <p-button
        label="Сохранить изменения"
        styleClass="p-button-raised mt-3"
        [loading]="userFormLoading"
        [disabled]="!userFormChanged"
        (click)="submitUserFrm()"></p-button>
    </form>
  </ng-template>
</p-panel>
<p-toast></p-toast>
